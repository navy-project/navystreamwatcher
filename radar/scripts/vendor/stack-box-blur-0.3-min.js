function stackBoxBlurImage(e,t,n,r,i){var s=document.getElementById(e);var o=s.naturalWidth;var u=s.naturalHeight;var a=document.getElementById(t);a.style.width=o+"px";a.style.height=u+"px";a.width=o;a.height=u;var f=a.getContext("2d");f.clearRect(0,0,o,u);f.drawImage(s,0,0);if(isNaN(n)||n<1)return;if(r)stackBoxBlurCanvasRGBA(t,0,0,o,u,n,i);else stackBoxBlurCanvasRGB(t,0,0,o,u,n,i)}function stackBoxBlurCanvasRGBA(e,t,n,r,i,s,o){if(isNaN(s)||s<1)return;s|=0;if(isNaN(o))o=1;o|=0;if(o>3)o=3;if(o<1)o=1;var u=document.getElementById(e);var a=u.getContext("2d");var f;try{try{f=a.getImageData(t,n,r,i)}catch(l){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");f=a.getImageData(t,n,r,i)}catch(l){alert("Cannot access local image");throw new Error("unable to access local image data: "+l);return}}}catch(l){alert("Cannot access image");throw new Error("unable to access image data: "+l)}var c=f.data;var h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H;var B=s+s+1;var j=r<<2;var F=r-1;var I=i-1;var q=s+1;var R=new BlurStack;var U=R;for(d=1;d<B;d++){U=U.next=new BlurStack;if(d==q)var z=U}U.next=R;var W=null;var X=mul_table[s];var V=shg_table[s];while(o-->0){y=g=0;for(p=i;--p>-1;){b=q*(M=c[g]);w=q*(_=c[g+1]);E=q*(D=c[g+2]);S=q*(P=c[g+3]);U=R;for(d=q;--d>-1;){U.r=M;U.g=_;U.b=D;U.a=P;U=U.next}for(d=1;d<q;d++){v=g+((F<d?F:d)<<2);b+=U.r=c[v];w+=U.g=c[v+1];E+=U.b=c[v+2];S+=U.a=c[v+3];U=U.next}W=R;for(h=0;h<r;h++){c[g++]=b*X>>>V;c[g++]=w*X>>>V;c[g++]=E*X>>>V;c[g++]=S*X>>>V;v=y+((v=h+s+1)<F?v:F)<<2;b-=W.r-(W.r=c[v]);w-=W.g-(W.g=c[v+1]);E-=W.b-(W.b=c[v+2]);S-=W.a-(W.a=c[v+3]);W=W.next}y+=r}for(h=0;h<r;h++){g=h<<2;b=q*(M=c[g]);w=q*(_=c[g+1]);E=q*(D=c[g+2]);S=q*(P=c[g+3]);U=R;for(d=0;d<q;d++){U.r=M;U.g=_;U.b=D;U.a=P;U=U.next}m=r;for(d=1;d<=s;d++){g=m+h<<2;b+=U.r=c[g];w+=U.g=c[g+1];E+=U.b=c[g+2];S+=U.a=c[g+3];U=U.next;if(d<I){m+=r}}g=h;W=R;for(p=0;p<i;p++){v=g<<2;c[v+3]=P=S*X>>>V;if(P>0){P=255/P;c[v]=(b*X>>>V)*P;c[v+1]=(w*X>>>V)*P;c[v+2]=(E*X>>>V)*P}else{c[v]=c[v+1]=c[v+2]=0}v=h+((v=p+q)<I?v:I)*r<<2;b-=W.r-(W.r=c[v]);w-=W.g-(W.g=c[v+1]);E-=W.b-(W.b=c[v+2]);S-=W.a-(W.a=c[v+3]);W=W.next;g+=r}}}a.putImageData(f,t,n)}function stackBoxBlurCanvasRGB(e,t,n,r,i,s,o){if(isNaN(s)||s<1)return;s|=0;if(isNaN(o))o=1;o|=0;if(o>3)o=3;if(o<1)o=1;var u=document.getElementById(e);var a=u.getContext("2d");var f;try{try{f=a.getImageData(t,n,r,i)}catch(l){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");f=a.getImageData(t,n,r,i)}catch(l){alert("Cannot access local image");throw new Error("unable to access local image data: "+l);return}}}catch(l){alert("Cannot access image");throw new Error("unable to access image data: "+l)}var c=f.data;var h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;var _=s+s+1;var D=r<<2;var P=r-1;var H=i-1;var B=s+1;var j=new BlurStack;var F=j;for(d=1;d<_;d++){F=F.next=new BlurStack;if(d==B)var I=F}F.next=j;var q=null;var R=mul_table[s];var U=shg_table[s];while(o-->0){y=g=0;for(p=i;--p>-1;){b=B*(L=c[g]);w=B*(A=c[g+1]);E=B*(O=c[g+2]);F=j;for(d=B;--d>-1;){F.r=L;F.g=A;F.b=O;F=F.next}for(d=1;d<B;d++){v=g+((P<d?P:d)<<2);b+=F.r=c[v++];w+=F.g=c[v++];E+=F.b=c[v];F=F.next}q=j;for(h=0;h<r;h++){c[g++]=b*R>>>U;c[g++]=w*R>>>U;c[g++]=E*R>>>U;g++;v=y+((v=h+s+1)<P?v:P)<<2;b-=q.r-(q.r=c[v++]);w-=q.g-(q.g=c[v++]);E-=q.b-(q.b=c[v]);q=q.next}y+=r}for(h=0;h<r;h++){g=h<<2;b=B*(L=c[g++]);w=B*(A=c[g++]);E=B*(O=c[g]);F=j;for(d=0;d<B;d++){F.r=L;F.g=A;F.b=O;F=F.next}m=r;for(d=1;d<=s;d++){g=m+h<<2;b+=F.r=c[g++];w+=F.g=c[g++];E+=F.b=c[g];F=F.next;if(d<H)m+=r}g=h;q=j;for(p=0;p<i;p++){v=g<<2;c[v]=b*R>>>U;c[v+1]=w*R>>>U;c[v+2]=E*R>>>U;v=h+((v=p+B)<H?v:H)*r<<2;b-=q.r-(q.r=c[v]);w-=q.g-(q.g=c[v+1]);E-=q.b-(q.b=c[v+2]);q=q.next;g+=r}}}a.putImageData(f,t,n)}function BlurStack(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null}var mul_table=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1];var shg_table=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9]